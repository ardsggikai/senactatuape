#Autor: Allan Richard De Souza Gomes
#Data de criação: 26/05/2022
#Data de atualização: 29/05/2022
#Versão: 0.03

LAMP usa servidor web Apache 2 que é popular e usado pela maioria. Você pode instalar Apache usando pacote de gerenciador do Ubuntu como mostramos abaixo:

Estes comandos pedem que você forneça senhas. Pressione Y no prompt de comando e aperte ENTER para continuar a instalação.

O Firewall UFW está disponível em todas as instalações Ubuntu por padrão. O firewall UFW deve permitir tráfego HTTP e HTTPS. Se você não quer usar UFW, sinta-se à vontade para pular este passo. Você pode checar o perfil da aplicação UFW usando o seguinte comando:

sudo ufw app list

Isto fornecerá uma saída como:

Available applications:

 Apache

 Apache Full

 Apache Secure

 OpenSSH
Para permitir tráfego HTTP e HTTPS para o perfil Apache Full, você pode executar o comando abaixo:

sudo ufw allow in "Apache Full"
Para confirmar, confira as informações do perfil usando:

sudo ufw app info "Apache Full"
Para verificar se o Apache foi instalado corretamente, você precisa do endereço de IP público. Você pode conseguir isto usando o comando abaixo:

ip addr show eth0 | grep inet | awk '{ print $2; }' | sed 's/\/.*$//'
Este comando vai te fornecer 2-3 IPs. Você deve tentar todos eles usando http://your_public_IPAddress no navegador. Uma página Ubuntu Apache será exibida como padrão.

Configuração MySQL para WordPress
Você precisa fazer login no MySQL como usuário root. Para fazer isto, use o comando abaixo:

mysql -u root -p
Você receberá um aviso para digitar a senha do root, que você configurou anteriormente. Depois de ter logado, você pode criar um banco de dados separado para o WordPress.

Abaixo, criamos um novo banco de dados chamado WordPressDB:

mysql> CREATE DATABASE WordPressDB DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci;
Em seguida, você vai criar um usuário separado para o WordPress. Coloque o nome como WordPressUser. Para criar um novo usuário e garantir privilégios, use o comando abaixo:

mysql> GRANT ALL ON WordPressDB.* TO ' WordPressUser '@'localhost' IDENTIFIED BY 'NewPasswordToBeSet';
Crie uma senha mais forte e substitua NewPasswordToBeSet. Para aplicar as mudanças, use o comando:

mysql> FLUSH PRIVILEGES;
Quando tiver terminado, saia do prompt MySQL.
>exit

Instalar WordPress no Ubuntu
Crie um arquivo de configuração, por exemplo: WordPress.conf Salve no /etc/apache2/sites-available/. Esta será uma réplica do arquivo de configuração padrão que já existe neste local.

#Verifique em que diretorio você esta

pwd

#Depois Va para o diretorio

cd /etc/apache2/sites-available/

mkdir WordPress.conf

Exit

Dica: Não esqueça, todos os nomes do Linux são sensitivos para letras maiúsculas e minúsculas.

Além disso, crie um diretório WordPress (ou você pode fornecer qualquer outro nome no local /var/www/). O local completo será /var/www/wordpress.

cd /var/www/

$ sudo mkdir wordpress
#OBSERVAÇÃO Vai pedir Senha

O arquivo WordPress.conf será o arquivo de configuração do Apache Apache para este teste. No arquivo, você pode habilitar .htaccess adicionando estas linhas ao bloco VirtualHost:

<Directory /var/www/wordpress />   

   AllowOverride All

</Directory>
Quando finalizar a edição, salve o arquivo.

Em seguida, você pode hablitar o mod_rewrite para usar o recurso de permalink do WordPress. Você pode fazer isto usando:

sudo a2enmod rewrite
--------------------------------------------------------------------------------------------------------------------
#Siga os Passos
#OBSERVAÇÃO CASO OCORRA O ERRO Error AH00558: Could not reliably determine the server's fully qualified domain name
#Aki Você Adiciona o seu Dominio
$ sudo vim /etc/apache2/apache2.conf

Adicione uma linha contendo ServerName 127.0.0.1 ao final do arquivo:

. . .
# Include the virtual host configurations:
IncludeOptional sites-enabled/*.conf

# vim: syntax=apache ts=4 sw=4 sts=4 sr noet
ServerName 127.0.0.1
--------------------------------------------------------------------------------------------------------------------
#Pode Executar de novo
sudo a2enmod rewrite

Module rewrite already enable

No arquivo /etc/apache2/apache2.conf, você pode alterar o diretivo ServerName fornecendo o IP do servidor ou o hostname.

Você pode testar esta configuração completa usando o comando abaixo.


Certifique-se de que a mensagem OK da Sintaxe esteja correta. Se tiver outra mensagem adicional, você pode ignorar, pois isso não afetará a instalação.

sudo apache2ctl configtest
Para ver as alterações feitas, reinicie o servidor Apache usando o comando restart mencionado anteriormente:

sudo systemctl restart apache2
Configurar e Instalar WordPress no Ubuntu
Você pode alterar o local para um diretório e iniciar o download do WordPress. Você pode fazer conforme mostramos abaixo:

cd /tmp

curl -O https://wordpress.org/latest.tar.gz
Extraia este arquivo usando:

tar xzvf latest.tar.gz
Aqui você pode criar o arquivo .htaccess:

vi /tmp/wordpress/.htaccess
Salve o arquivo. 
#OBSERVAÇÃO ESQ SHIFT+: x (enter)

exit

Troque o nome do arquivo wp-config-sample.php usando o comando:

mv /tmp/wordpress/wp-config-sample.php /tmp/wordpress/wp-config.php
Crie a pasta abaixo no local indicado:

mkdir /tmp/wordpress/wp-content/upgrade
Com isto, você completa as configurações iniciais que podem ser copiadas para o documento root.

sudo cp -a /tmp/wordpress/. /var/www/wordpress
Para assegurar que tudo está funcionando corretamente, você terá que alterar o proprietário do arquivo WordPress para usuários e grupos www-data. Estes são os usuários que o servidor web Apache irá usar.

Para alterar a propriedade, você pode usar este comando:

sudo chown -R www-data:www-data /var/www/wordpress
Also, you will have to set the correct permission to the directories and files:

sudo find /var/www/wordpress/ -type d -exec chmod 750 {} \;

sudo find /var/www/wordpress/ -type f -exec chmod 640 {} \;
Para a configuração inicial, é necessário gerar o salt do WordPress. Isso pode ser feito usando:

curl -s https://api.wordpress.org/secret-key/1.1/salt/
Ele dará uma saída diferente a cada vez e conterá uma lista de valores salt. A saída do comando acima precisa ser copiada e adicionada ao arquivo wp-config.php. #Acredite você vai ter que utilizar.. (escreva na unha)
ou utilize https://www.prepostseo.com/br/image-to-text

sudo vi /var/www/wordpress/wp-config.php
Substitua os valores fictícios existentes nesse arquivo. Salve o arquivo depois de fazer as alterações.

O arquivo wp-config.php contém algumas configurações do banco de dados no topo. Substitua o DB_NAME, DB_USER, DB_PASSWORD pelos valores que você criou para o WordPress.

define('DB_NAME', 'WordPressDB');

/** MySQL database username */

define('DB_USER', 'WordPressUser');

/** MySQL database password */

define('DB_PASSWORD', 'DB_Password');
Além disso, você pode adicionar o método do sistema de arquivos na parte inferior, conforme mostrado abaixo:

define( 'FS_METHOD', 'direct' );
Salve o arquivo.

Isso conclui a configuração do back-end. Agora você pode acessar o WordPress através da interface usando a URL http://192.168.0.74:8888

O que vier a seguir será semelhante à configuração normal do WordPress. Primeiro, será pedido que você selecione um idioma.

Em seguida, você será redirecionado para uma página na qual poderá definir o nome de usuário e a senha.

Certifique-se de alterar o nome de usuário e a senha para melhorar a segurança do WordPress. Ao pressionar o botão Instalar WordPress, você completará sua configuração do WordPress e será solicitado a acessar a tela de login.

Forneça o nome de usuário e senha WordPress para acessar o painel de controle.

Easter Egg: Webmin>Tools>File Manager>var>www>wordpress>